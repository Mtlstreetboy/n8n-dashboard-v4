flowchart TD
    %% Entry Point
    DAILY["â° daily_automation.py<br/>(orchestrateur principal)"]:::main
    
    %% Step 1: Collecte Options
    DAILY -->|1. Lance| OPTS["ğŸ“Š collect_options.py<br/>(Yahoo Finance API)"]:::collector
    OPTS -->|gÃ©nÃ¨re| OPTS_CSV["ğŸ“ options/*.csv<br/>(put/call volumes)"]:::data
    OPTS_CSV -->|consommÃ© par| ANALYSIS
    
    %% Step 2: Collecte News
    DAILY -->|2. Lance| NEWS["ğŸ“° batch_loader_v2.py<br/>(Google News API)"]:::collector
    NEWS -->|gÃ©nÃ¨re| NEWS_JSON["ğŸ“ companies/*_news.json<br/>(articles 30j)"]:::data
    NEWS_JSON -->|consommÃ© par| ANALYSIS
    
    %% Step 3: Configuration
    CONFIG["âš™ï¸ companies_config.py<br/>(liste 15 tickers)"]:::config
    CONFIG -->|dÃ©finit| ANALYSIS
    
    %% Step 3: Analyse Sentiment
    DAILY -->|3. Lance| ANALYZE["ğŸ”„ analyze_all_sentiment.py<br/>(orchestrateur batch)"]:::processor
    
    ANALYZE -->|pour chaque ticker| ANALYSIS["ğŸ§  advanced_sentiment_engine_v4.py<br/>(moteur sentiment)"]:::processor
    
    %% Sub-modules de V4
    ANALYSIS -->|utilise| FINBERT["ğŸ“Š finbert_analyzer.py<br/>(FinBERT model)"]:::analyzer
    ANALYSIS -->|utilise| ANALYST["ğŸ‘” analyst_insights_integration.py<br/>(6Ã¨me dimension)"]:::analyzer
    ANALYSIS -->|utilise| CONTEXT["ğŸ¯ contextual_sentiment_analyzer.py<br/>(Ã©vite cross-contamination)"]:::analyzer
    
    FINBERT -->|donnÃ©es| ANALYSIS
    ANALYST -->|donnÃ©es| ANALYSIS
    CONTEXT -->|donnÃ©es| ANALYSIS
    
    %% Inputs vers l'analyse
    NEWS_JSON -->|articles| ANALYSIS
    OPTS_CSV -->|options data| ANALYSIS
    CONFIG -->|ticker config| ANALYZE
    CONFIG -->|ticker config| ANALYSIS
    
    %% Output de l'analyse
    ANALYSIS -->|gÃ©nÃ¨re| SENTIMENT_JSON["ğŸ“ sentiment_analysis/*_latest_v4.json<br/>(6D scores + alerts)"]:::data
    
    %% Step 4: Visualisation
    SENTIMENT_JSON -->|embedded dans| DASHBOARD["ğŸ¨ dashboard_v4_split.html<br/>(React SPA)"]:::final
    DASHBOARD -->|affiche| USER["ğŸ‘ï¸ Utilisateur<br/>(15 tickers + 6D)"]:::user
    
    %% Logs et monitoring
    DAILY -.->|logs| LOGS["ğŸ“‹ logs/daily_automation.log"]:::support
    ANALYZE -.->|logs| LOGS
    ANALYSIS -.->|logs| LOGS
    
    %% Styling
    classDef main fill:#4a90e2,stroke:#2c5aa0,color:#fff,stroke-width:3px
    classDef collector fill:#7ed321,stroke:#5fa319,color:#fff,stroke-width:2px
    classDef data fill:#f5a623,stroke:#c17d11,color:#fff,stroke-width:2px
    classDef processor fill:#9013fe,stroke:#5e0ba0,color:#fff,stroke-width:2px
    classDef analyzer fill:#bd10e0,stroke:#7a0ba0,color:#fff,stroke-width:2px
    classDef final fill:#50e3c2,stroke:#2a8a6f,color:#333,stroke-width:3px
    classDef config fill:#ffb600,stroke:#b88600,color:#333,stroke-width:2px
    classDef user fill:#417505,stroke:#2a4f03,color:#fff,stroke-width:2px
    classDef support fill:#d0021b,stroke:#800010,color:#fff,stroke-width:1px