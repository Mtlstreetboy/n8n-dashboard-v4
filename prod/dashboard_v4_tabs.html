<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentiment V4 Dashboard - Tabs</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Embedded data (same as before)
        const EMBEDDED_DATA = { "NVDA": { "ticker": "NVDA", "timestamp": "2025-12-27T11:59:18.591365", "final_sentiment_score": 0.3603, "classification": "HOLD", "confidence_level": "LOW", "conviction_score": 0.2551, "smart_money_factor": 0.0732, "components": { "news_sentiment": 0.0185, "news_confidence": 0.5349, "news_weight": 0.2313, "options_sentiment": 0.2399, "options_confidence": 1.0, "options_weight": 0.6486, "analyst_sentiment": 0.8359, "analyst_confidence": 0.3333, "analyst_weight": 0.1201, "narrative_momentum": 0.0, "fear_greed_asymmetry": 0.1 }, "divergence_analysis": { "type": "aligned", "magnitude": 0.2213, "opportunity_score": 0, "interpretation": "ü§ù Consensus - Nouvelles et march√©s s'accordent" }, "metadata": { "news_articles_count": 634, "options_volume": 1506064, "analysis_depth": "DEEP", "config_rationale": "NVDA est une action tech √† forte volatilit√©, n√©cessitant un d√©clin temporel plus rapide et une sensibilit√© plus √©lev√©e aux indicateurs de momentum.", "version": "V4 - Dual Brain" }, "analyst_insights": { "recommendation_mean": 1.32812, "recommendation_count": 57, "recommendation_summary": "Strong Buy consensus (Mean: 1.3)", "recommendation_score": 0.836, "target_mean": 253.01825, "target_median": 250.0, "current_price": 190.53, "upside_potential": 0.32797066078832726, "price_target_score": 0.576, "upgrades_30d": 0, "downgrades_30d": 0, "net_changes_30d": 0, "momentum_score": 0, "weights": { "rec": 1.0, "pt": 0.0, "momentum": 0.0 }, "component_confidences": { "recommendation": 1.0, "price_target": 0.0, "momentum": 0 } }, "volatility_regime": { "regime": "HIGH_VOLATILITY", "sub_regime": "EUPHORIA", "confidence": 1.0, "metrics": { "avg_iv": 1.3711499999999999, "iv_skew": -0.5734276647765698, "pcr_volume": 0.609 }, "implications": "üé¢ EUPHORIE - Volatilit√© √©lev√©e avec optimisme. Attention aux corrections. | üìû Call skew √©lev√© - Sp√©culation haussi√®re agressive", "signal_adjustment": -0.15, "recommendation": "Prendre profits partiels. R√©duire exposition. Volatilit√© = risque bidirectionnel." }, "catalysts": { "catalysts_detected": [{ "type": "merger_acquisition", "category": "CORPORATE_ACTION", "timestamp": "2025-12-27T06:39:41+00:00", "confidence": 0.333, "sentiment": 0.867, "impact_score": 0.289, "title": "NVIDIA Stock (+1.0%): Groq Licensing Deal Solidifies AI Moat - Trefis", "matches": 1 }], "count": 4, "most_recent": { "type": "merger_acquisition", "category": "CORPORATE_ACTION", "timestamp": "2025-12-27T06:39:41+00:00", "confidence": 0.333, "sentiment": 0.867, "impact_score": 0.289, "title": "NVIDIA Stock (+1.0%): Groq Licensing Deal Solidifies AI Moat - Trefis", "matches": 1 }, "impact_assessment": "LOW_IMPACT", "recommendation": "‚úì Catalyseurs mineurs. Impact limit√© sur tendance globale.", "categories_present": ["ANALYST", "MANAGEMENT", "CORPORATE_ACTION", "FINANCIAL"] }, "advanced_metrics": { "sharpe_ratio": 0.573, "sentiment_volatility": 0.398, "momentum_acceleration": 0.0, "contrarian_score": 0, "sentiment_consistency": 0.0, "llm_interpretation": "Je ne peux pas fournir de conseils d'investissement. Pourrais-je vous aider avec autre chose ?" }, "alerts": [{ "priority": "HIGH", "type": "VOLATILITY", "icon": "üå™Ô∏è", "title": "R√âGIME DE HAUTE VOLATILIT√â", "message": "üé¢ EUPHORIE - Volatilit√© √©lev√©e avec optimisme. Attention aux corrections. | üìû Call skew √©lev√© - Sp√©culation haussi√®re agressive", "action": "Prendre profits partiels. R√©duire exposition. Volatilit√© = risque bidirectionnel.", "urgency": "IMMEDIATE" }], "options_detail": { "ticker": "NVDA", "timestamp": "2025-12-27T11:34:07.841165", "call_volume": 936286, "put_volume": 569778, "call_open_interest": 4833977, "put_open_interest": 4023756, "put_call_ratio_volume": 0.609, "put_call_ratio_oi": 0.832, "call_implied_volatility": 1.9223, "put_implied_volatility": 0.82, "sentiment_label": "bullish", "sentiment_score": 0.391, "total_contracts": 1506064, "total_open_interest": 8857733, "near_term_call_volume": 759196, "far_term_call_volume": 177090, "near_term_put_volume": 407316, "far_term_put_volume": 162462 } } };

        // Utility functions
        const getSentimentColor = (score) => {
            if (score > 0.5) return 'text-green-500';
            if (score > 0.2) return 'text-green-400';
            if (score < -0.5) return 'text-red-500';
            if (score < -0.2) return 'text-red-400';
            return 'text-yellow-500';
        };

        const getSentimentBg = (score) => {
            if (score > 0.5) return 'bg-green-500';
            if (score > 0.2) return 'bg-green-400';
            if (score < -0.5) return 'bg-red-500';
            if (score < -0.2) return 'bg-red-400';
            return 'bg-yellow-500';
        };

        // Ticker Card with Tabs
        const TickerCard = ({ ticker, data }) => {
            const [activeTab, setActiveTab] = useState('sentiment');
            const gaugePosition = ((data.final_sentiment_score + 1) / 2) * 100;

            return (
                <div className="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl overflow-hidden">
                    {/* Header with Ticker */}
                    <div className="p-4 border-b border-slate-700">
                        <div className="flex items-center justify-between mb-3">
                            <div className="text-2xl font-bold text-white">{ticker}</div>
                            <div className={`text-3xl font-bold ${getSentimentColor(data.final_sentiment_score)}`}>
                                {data.final_sentiment_score > 0 ? '+' : ''}{(data.final_sentiment_score * 100).toFixed(1)}
                            </div>
                        </div>

                        {/* Tabs */}
                        <div className="flex gap-2">
                            <button
                                onClick={() => setActiveTab('sentiment')}
                                className={`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${activeTab === 'sentiment'
                                        ? 'bg-cyan-600 text-white'
                                        : 'bg-slate-700/50 text-slate-400 hover:bg-slate-700'
                                    }`}
                            >
                                üìä Sentiment
                            </button>
                            <button
                                onClick={() => setActiveTab('options')}
                                className={`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${activeTab === 'options'
                                        ? 'bg-purple-600 text-white'
                                        : 'bg-slate-700/50 text-slate-400 hover:bg-slate-700'
                                    }`}
                            >
                                üìà Options
                            </button>
                        </div>
                    </div>

                    {/* Tab Content */}
                    <div className="p-4 max-h-96 overflow-y-auto">
                        {activeTab === 'sentiment' ? (
                            <SentimentTab data={data} gaugePosition={gaugePosition} />
                        ) : (
                            <OptionsTab data={data} />
                        )}
                    </div>
                </div>
            );
        };

        // Sentiment Tab Component
        const SentimentTab = ({ data, gaugePosition }) => (
            <div className="space-y-4">
                {/* Classification & Conviction */}
                <div className="grid grid-cols-2 gap-3">
                    <div>
                        <div className="text-xs text-slate-400 mb-1">Classification</div>
                        <div className={`text-lg font-bold ${getSentimentColor(data.final_sentiment_score)}`}>
                            {data.classification}
                        </div>
                    </div>
                    <div>
                        <div className="text-xs text-slate-400 mb-1">Conviction</div>
                        <div className="text-lg font-bold text-white">
                            {(data.conviction_score * 100).toFixed(0)}%
                        </div>
                    </div>
                </div>

                {/* Gauge */}
                <div>
                    <div className="text-xs text-slate-400 mb-2">Sentiment Global</div>
                    <div className="relative h-8 rounded-lg overflow-hidden bg-gradient-to-r from-red-600 via-yellow-500 to-green-600">
                        <div
                            className="absolute top-0 bottom-0 w-1 bg-white shadow-lg"
                            style={{ left: `${gaugePosition}%` }}
                        />
                    </div>
                </div>

                {/* Components */}
                <div className="space-y-2">
                    <div className="text-xs font-semibold text-slate-300 mb-2">Composantes</div>

                    <div className="flex justify-between items-center text-sm">
                        <span className="text-slate-400">üì∞ News</span>
                        <span className={`font-bold ${getSentimentColor(data.components.news_sentiment)}`}>
                            {data.components.news_sentiment > 0 ? '+' : ''}{data.components.news_sentiment.toFixed(3)}
                        </span>
                    </div>

                    <div className="flex justify-between items-center text-sm">
                        <span className="text-slate-400">üìä Options</span>
                        <span className={`font-bold ${getSentimentColor(data.components.options_sentiment)}`}>
                            {data.components.options_sentiment > 0 ? '+' : ''}{data.components.options_sentiment.toFixed(3)}
                        </span>
                    </div>

                    <div className="flex justify-between items-center text-sm">
                        <span className="text-slate-400">üë• Analysts</span>
                        <span className={`font-bold ${getSentimentColor(data.components.analyst_sentiment)}`}>
                            {data.components.analyst_sentiment > 0 ? '+' : ''}{data.components.analyst_sentiment.toFixed(3)}
                        </span>
                    </div>
                </div>

                {/* Analyst Insights */}
                {data.analyst_insights && (
                    <div className="bg-purple-900/20 rounded-lg p-3 border border-purple-600/30">
                        <div className="text-xs font-semibold text-slate-300 mb-2">Analyst Insights</div>
                        <div className="grid grid-cols-2 gap-2 text-xs">
                            <div>
                                <div className="text-slate-400">Recommandation</div>
                                <div className="text-white font-bold">{data.analyst_insights.recommendation_summary}</div>
                            </div>
                            <div>
                                <div className="text-slate-400">Price Target</div>
                                <div className="text-green-400 font-bold">
                                    ${data.analyst_insights.target_mean?.toFixed(0) || 'N/A'}
                                </div>
                            </div>
                        </div>
                    </div>
                )}

                {/* Alerts */}
                {data.alerts && data.alerts.length > 0 && (
                    <div className="bg-red-900/20 rounded-lg p-3 border border-red-600/30">
                        <div className="text-xs font-semibold text-slate-300 mb-2">
                            üö® Alertes ({data.alerts.length})
                        </div>
                        {data.alerts.slice(0, 2).map((alert, idx) => (
                            <div key={idx} className="text-xs text-slate-300 mb-1">
                                {alert.icon} {alert.title}
                            </div>
                        ))}
                    </div>
                )}
            </div>
        );

        // Options Tab Component
        const OptionsTab = ({ data }) => {
            const opts = data.options_detail;
            if (!opts) {
                return <div className="text-slate-400 text-center py-8">Donn√©es d'options non disponibles</div>;
            }

            const pcrVolume = opts.put_call_ratio_volume;
            const pcrOI = opts.put_call_ratio_oi;
            const callIV = opts.call_implied_volatility;
            const putIV = opts.put_implied_volatility;
            const ivSkew = callIV - putIV;

            return (
                <div className="space-y-4">
                    {/* Key Metrics */}
                    <div className="grid grid-cols-2 gap-3">
                        <div className="bg-slate-700/50 rounded-lg p-3">
                            <div className="text-xs text-slate-400 mb-1">Sentiment</div>
                            <div className={`text-lg font-bold ${opts.sentiment_label === 'bullish' ? 'text-green-400' : opts.sentiment_label === 'bearish' ? 'text-red-400' : 'text-yellow-400'}`}>
                                {opts.sentiment_label.toUpperCase()}
                            </div>
                        </div>
                        <div className="bg-slate-700/50 rounded-lg p-3">
                            <div className="text-xs text-slate-400 mb-1">Volume Total</div>
                            <div className="text-lg font-bold text-white">
                                {(opts.total_contracts / 1000).toFixed(0)}K
                            </div>
                        </div>
                    </div>

                    {/* PCR Volume */}
                    <div>
                        <div className="text-xs font-semibold text-slate-300 mb-2">Put/Call Ratio - Volume</div>
                        <div className={`text-2xl font-bold mb-2 ${(pcrVolume < 0.7) ? 'text-green-400' : (pcrVolume > 1.0) ? 'text-red-400' : 'text-yellow-400'}`}>
                            {pcrVolume.toFixed(3)}
                        </div>
                        <div className="space-y-2">
                            <div className="flex justify-between text-xs">
                                <span className="text-slate-400">Calls</span>
                                <span className="text-green-400 font-bold">{opts.call_volume.toLocaleString()}</span>
                            </div>
                            <div className="w-full bg-slate-700 rounded-full h-2">
                                <div className="bg-green-500 h-2 rounded-full" style={{ width: `${(opts.call_volume / opts.total_contracts) * 100}%` }}></div>
                            </div>
                            <div className="flex justify-between text-xs">
                                <span className="text-slate-400">Puts</span>
                                <span className="text-red-400 font-bold">{opts.put_volume.toLocaleString()}</span>
                            </div>
                            <div className="w-full bg-slate-700 rounded-full h-2">
                                <div className="bg-red-500 h-2 rounded-full" style={{ width: `${(opts.put_volume / opts.total_contracts) * 100}%` }}></div>
                            </div>
                        </div>
                    </div>

                    {/* Implied Volatility */}
                    <div>
                        <div className="text-xs font-semibold text-slate-300 mb-2">Implied Volatility</div>
                        <div className="grid grid-cols-3 gap-2">
                            <div className="bg-slate-700/50 rounded-lg p-2">
                                <div className="text-xs text-slate-400">Call IV</div>
                                <div className="text-sm font-bold text-green-400">{(callIV * 100).toFixed(1)}%</div>
                            </div>
                            <div className="bg-slate-700/50 rounded-lg p-2">
                                <div className="text-xs text-slate-400">Put IV</div>
                                <div className="text-sm font-bold text-red-400">{(putIV * 100).toFixed(1)}%</div>
                            </div>
                            <div className="bg-slate-700/50 rounded-lg p-2">
                                <div className="text-xs text-slate-400">Skew</div>
                                <div className={`text-sm font-bold ${(ivSkew > 0) ? 'text-orange-400' : 'text-purple-400'}`}>
                                    {(ivSkew > 0) ? '+' : ''}{(ivSkew * 100).toFixed(1)}%
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Open Interest */}
                    <div>
                        <div className="text-xs font-semibold text-slate-300 mb-2">Open Interest</div>
                        <div className="grid grid-cols-2 gap-2 text-xs">
                            <div>
                                <div className="text-slate-400">Call OI</div>
                                <div className="text-green-400 font-bold">{(opts.call_open_interest / 1000).toFixed(0)}K</div>
                            </div>
                            <div>
                                <div className="text-slate-400">Put OI</div>
                                <div className="text-red-400 font-bold">{(opts.put_open_interest / 1000).toFixed(0)}K</div>
                            </div>
                        </div>
                    </div>

                    {/* Interpretation */}
                    <div className="bg-purple-900/20 rounded-lg p-3 border border-purple-600/30">
                        <div className="text-xs font-semibold text-slate-300 mb-1">üí° Interpr√©tation</div>
                        <div className="text-xs text-slate-300">
                            {(pcrVolume < 0.7) ? 'üöÄ Forte demande pour les calls - Positionnement haussier agressif.' :
                                (pcrVolume > 1.0) ? 'üêª Pr√©f√©rence pour les puts - Couverture ou paris baissiers.' :
                                    '‚öñÔ∏è PCR √©quilibr√© - March√© ind√©cis ou hedging sym√©trique.'}
                        </div>
                    </div>
                </div>
            );
        };

        // Main App
        const App = () => {
            const [tickersData, setTickersData] = useState([]);

            React.useEffect(() => {
                const data = Object.entries(EMBEDDED_DATA).map(([ticker, data]) => ({
                    ticker,
                    data,
                    loaded: true
                }));
                setTickersData(data);
            }, []);

            if (tickersData.length === 0) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center">
                        <div className="text-white text-2xl">Chargement...</div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-6">
                    <div className="max-w-7xl mx-auto">
                        {/* Header */}
                        <div className="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-2xl p-6 mb-6">
                            <h1 className="text-4xl font-bold text-white mb-2">
                                üß† Sentiment Dashboard V4 - Tabs Edition
                            </h1>
                            <p className="text-slate-400">
                                {tickersData.length} tickers analys√©s ‚Ä¢ Cliquez sur les onglets pour explorer
                            </p>
                        </div>

                        {/* Grid */}
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {tickersData.map(({ ticker, data }) => (
                                <TickerCard key={ticker} ticker={ticker} data={data} />
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>

</html>